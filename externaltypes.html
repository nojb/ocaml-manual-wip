<!DOCTYPE html>
<html lang="en">
<head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.36">

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<link rel="stylesheet" type="text/css" href="manual.css">
<title>12.27 External types</title>
</head>
<body>
<a href="labeledtuples.html"><img src="previous_motif.svg" alt="Previous"></a>
<a href="extn.html"><img src="contents_motif.svg" alt="Up"></a>
<hr>
<h2 class="section" id="s:external-types"><a class="section-anchor" href="#s:external-types" aria-hidden="true">﻿</a>12.27 External types</h2>
<p>(Introduced in OCaml 5.5)</p><p>External types introduce types of values that are defined outside the
OCaml language (they cannot be defined as standard datatype or formed
by combining existing type constructors) because they are populated
from the foreign function interface. For example, a type <span class="machine"><span class="font-tt">gmp</span></span> of
arbitrary-length integers implementing by binding the <span class="machine"><span class="font-tt">Gmp</span></span> library
from C could be defined as follows:</p><div class="caml-example verbatim">

<div class="ocaml">



<div class="pre caml-input"><span class="ocamlkeyword">module</span> Gmp : <span class="ocamlkeyword">sig</span>
  <span class="ocamlkeyword">type</span> t = <span class="ocamlkeyword">external</span> <span class="ocamlstring">"gmp"</span>

  <span class="ocamlkeyword">val</span> of_int : int -&gt; t
  <span class="ocamlkeyword">val</span> add : t -&gt; t -&gt; t
  <span class="ocamlcomment">(* ... *)</span>
<span class="ocamlkeyword">end</span> = …</div></div>

</div><p>We say that <span class="machine"><span class="font-tt">Gmp.t</span></span> is an external type of name <span class="machine"><span class="font-tt">gmp</span></span>. External names
are not unique, it is possible to define two (distinct) external types
with the same name. On the other hand, the type-system enforces that
two external types with distinct names are different.</p><p>Before external types were available, users could use an abstract type
for this purpose, just with <span class="machine"><span class="font-tt">type gmp</span></span>. But this is less informative,
as the OCaml compiler must assume that abstract types could be defined
in an arbitrary way, and in particular an abstract type from another
module could be equal to any type.</p>
<h5 class="paragraph" id="sec356"><a class="section-anchor" href="#sec356" aria-hidden="true">﻿</a>Predefined types</h5>
<p>External types can be used in particular to define the built-in types
such as <span class="machine"><span class="font-tt">float</span></span>, <span class="machine"><span class="font-tt">string</span></span>, etc.</p><div class="caml-example verbatim">

<div class="ocaml">



<div class="pre caml-input"><span class="ocamlkeyword">type</span> float = <span class="ocamlkeyword">external</span> <span class="ocamlstring">"float"</span>
<span class="ocamlkeyword">type</span> string = <span class="ocamlkeyword">external</span> <span class="ocamlstring">"string"</span>
<span class="ocamlkeyword">type</span> 'a array = <span class="ocamlkeyword">external</span> <span class="ocamlstring">"array"</span>
<span class="ocamlkeyword">type</span> +'a iarray = <span class="ocamlkeyword">external</span> <span class="ocamlstring">"iarray"</span>
<span class="ocamlcomment">(* ... *)</span></div></div>

</div><p>

We know for example that <span class="machine"><span class="font-tt">float</span></span> and <span class="machine"><span class="font-tt">string</span></span> are distinct types, as
they have different names.</p><p>Remark: This is useful in particular when using predefined types as
GADT indices, incompatible constructors can be ruled out. See
<a href="gadts-tutorial.html#s%3Atypes-used-as-gadt-indices">7.8</a> for a discussion of GADT indices.</p>
<h5 class="paragraph" id="sec357"><a class="section-anchor" href="#sec357" aria-hidden="true">﻿</a>Variance and injectivity</h5>
<p> Like abstract types, the variance
of the parameters of external types must be specified by users, with
invariance assumed by default. Unlike abstract types, external types
are always injective.
</p><hr>
<a href="labeledtuples.html"><img src="previous_motif.svg" alt="Previous"></a>
<a href="extn.html"><img src="contents_motif.svg" alt="Up"></a>
</body>
</html>
